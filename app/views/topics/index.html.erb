<%# OK 1. View all topics %>
<%# OK 2. Add a link to the topic  %>
<%# OK 3. Be able to resolve the topic  %>
<%# OK 3. a. routes - patch for resolved and cancelled
<%# OK b. model - status -> pending, resolved, cancelled %>
<%# OK c. controller - def for resolved and cancelled %>
<%# OK 4. update the navbar to go to my topics %>
<%# 5. update view
        a.simple form and conditional to show if status changes then what
        b. if user booked it, hide name %>
<%# 6. if user booked it, hide the link to user's name%>
<div class = "container">
  <div class = "row">
    <div class = "col-5">
      <div class="item-3d">
        <div class="item-3d-content">
          <h4>Hi <strong><%= current_user.nickname %></strong>,<br>
            how are you?</h4>
          <p>Do you have a new topic?</p>
          <div>
            <%= render 'topic_form' %>
          </div>
        </div>
        <div class="item-3d-icon">
          <%= image_tag "1 Lady Clap.png", alt: "", width: "250vh" %>
        </div>
      </div>
    </div>
    <div class = "col-1">
    </div>
    <div class = "card-container col-6">
      <div class="page-header">
        <h2>My Topics</h2>
        <hr>
      </div>
      <% @sorted_topics.each do |topic| %>
        <div class="card">
          <div class="card-body" style=<%= "background-color:antiquewhite;" if topic.pending? %>>
            <%# if topic is cancelled %>
            <% if topic.cancelled? %>
              <h5 class="card-title-muted"><%= topic.name %> - Cancelled </h5>
              <p class="card-text-muted"><%= topic.description %></p>
              <p class="card-text-muted"> Topic Sempai:
                <% @sempais_by_topic[topic].each do |sempai| %>
                  <%= sempai.nickname %>
                <% end %></p>
              <%# if topic is resolved %>
            <% elsif topic.resolved? %>
              <h5 class="card-title"><%= topic.name %> - Resolved</h5>
              <p class="card-text"><%= topic.description %></p>
              <p class="card-text"> Topic Sempai:
                <% @sempais_by_topic[topic].each do |sempai| %>
                  <%= link_to sempai.nickname, sempai_path(id: sempai.id, topic_id: topic.id), class: "text-primary" %>
                  <%= link_to '(Leave a Review)', sempai_path(id: sempai.id, topic_id: topic.id), class: "text-success" %>
                <% end %></p>
              <div class="row my-2" style="display: inline-flex;">
                <div class="col">
                  <% topic.bookings.each do |booking| %>
                    <%= simple_form_for topic, url: topic_booking_path(id: booking.id, topic_id: topic.id), method: :get do |f| %>
                      <%= f.button :submit, 'See Chat History', class: "btn btn-secondary" %>
                    <% end %>
                  <% end %>
                </div>
              </div>
            <% else %>
              <h5 class="card-title"><%= topic.name %></h5>
              <p class="card-text"><%= topic.description %></p>
              <p class="card-text"> Topic Sempai/s:
                <% @sempais_by_topic[topic].each do |sempai| %>
                  <%= link_to sempai.nickname, sempai_path(id: sempai.id, topic_id: topic.id), class: "text-primary" %>
                <% end %>
              </p>
              <div class="row my-2" style="display: inline-flex;">
                <div class="col">
                  <% topic.bookings.each do |booking| %>
                    <%= simple_form_for topic, url: topic_booking_path(id: booking.id, topic_id: topic.id), method: :get do |f| %>
                      <%= f.button :submit, 'Booking Details', class: "btn btn-info" %>
                    <% end %>
                  <% end %>
                </div>
                <div class="col">
                  <%= simple_form_for topic, url: resolved_topic_path(topic), method: :patch do |f| %>
                    <%= f.button :submit, 'Resolve', class: "btn btn-primary" %>
                  <% end %>
                </div>
                <div class="col">
                  <%= simple_form_for topic, url: cancelled_topic_path(topic), method: :patch do |f| %>
                    <%= f.button :submit, 'Cancel', class: "btn btn-danger" %>
                  <% end %>
                </div>
              </div>
            <% end %> <%# end for if %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>
